name: LDAP注入攻击检测 (优化版)
pattern:
  # 更精确的LDAP注入检测，结合上下文和特定语法
  url: '([&|!()=*,~<>].*\(|\(.*[&|!()=*,~<>])'
  user_agent: 'ldap[-_\s]*(injection|scanner|exploit)'
  params: '(&\([^)]+\)\([^)]+\))|(\([^\)]*[&|!~<>=].*\))'
severity: high
category: injection
description: |
  检测LDAP注入攻击，包括：
  - LDAP查询语法滥用 (&, |, !, =, *, ~, <, >)
  - 括号嵌套攻击
  - 特殊字符组合攻击

  优化点：
  - 避免误报正常URL中的括号
  - 结合参数上下文检测
  - 增加用户代理识别
cwe: "CWE-90"
references:
  - "https://owasp.org/www-community/attacks/LDAP_Injection"
  - "https://attack.mitre.org/techniques/T1190/"
attack_patterns:
  - "LDAP查询操纵"
  - "认证绕过"
  - "信息泄露"
response_codes: [200, 401, 403, 500]
threat_level: "high"
impact: "可能导致认证绕过、数据泄露或权限提升"